<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>OPENIPC AP-FPV</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body {
      font-family: sans-serif;
      background: #eef4fb;
      margin: 0; padding: 1.5em;
      color: #003366;
      text-align: center;
    }
    h1 {
      color: #0059b3;
      font-size: 1.6em;
      margin-bottom: 1em;
    }
    .btn {
      display: block;
      width: 80%;
      max-width: 300px;
      margin: 0.4em auto;
      padding: 0.8em;
      font-size: 1em;
      color: white;
      background: #007bff;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }
    .btn:hover {
      background: #0056b3;
    }
    select, input {
      width: 80%;
      max-width: 300px;
      padding: 0.6em;
      margin: 0.4em auto;
      font-size: 1em;
      border: 1px solid #ccc;
      border-radius: 6px;
      display: block;
    }
    pre#info {
      margin-top: 2em;
      padding: 1em;
      background: #dceaff;
      border: 1px solid #339;
      border-radius: 6px;
      white-space: pre-wrap;
      text-align: left;
      max-width: 90%;
      margin-left: auto;
      margin-right: auto;
      min-height: 8em;
      font-size: 0.9em;
    }
  </style>
</head>
<body>

  <h1>OPENIPC AP-FPV</h1>

  <!-- Buttons -->
  <button class="btn" onclick="go('led_on')">LED On</button>
  <button class="btn" onclick="go('led_off')">LED Off</button>

  <!-- Dropdown for channel selection -->
  <select id="chSel">
    <option value="ch36">ch36</option>
    <option value="ch100">ch100</option>
    <option value="ch161">ch161</option>
  </select>
  <button class="btn" onclick="goArg('set_chan', chSel.value)">Set Channel</button>

  <!-- Textbox for password -->
  <input id="pass" placeholder="New Wi-Fi password">
  <button class="btn" onclick="goArg('fw_set', pass.value)">Save Password</button>

  <!-- Info panel -->
  <pre id="info">(loading...)</pre>

<script>
function render(txt){
  document.getElementById('info').textContent = txt;
}

function go(name){
  fetch('/cmd/' + name)
    .then(r => r.text()).then(render)
    .catch(e => render('Fetch error: ' + e));
}

function goArg(name, arg){
  const q = '?args=' + encodeURIComponent(arg);
  fetch('/cmd/' + name + q)
    .then(r => r.text()).then(render)
    .catch(e => render('Fetch error: ' + e));
}

// Load system info on page load
window.onload = function(){
  fetch('/cmd/sysinfo?args=' + encodeURIComponent('-c -f -v -l -i -S -v -F'))
    .then(r => r.text()).then(render)
    .catch(e => render('Error loading info: ' + e));
};
</script>
</body>
</html>
